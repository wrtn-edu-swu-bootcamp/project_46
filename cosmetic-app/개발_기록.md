# 화장품 성분 사전 앱 개발 기록

## 📱 프로젝트 개요

| 항목 | 내용 |
|------|------|
| **프로젝트명** | 화장품 성분 사전 (가칭) |
| **기술 스택** | Next.js 14, React, TypeScript, Tailwind CSS |
| **주요 기능** | 성분 검색, AI 뷰티 상담, 팁 제공, 다크모드 |
| **외부 API** | 식약처 화장품 원료성분정보 API, Groq AI API |

---

## ✅ 구현된 기능

### 1. 성분 검색 시스템
- **로컬 데이터베이스**: 21개 주요 화장품 성분 정보 (PDRN, 펩타이드, 레티놀 등)
- **식약처 API 연동**: 2만개+ 화장품 원료성분 실시간 검색
- **검색 UI**: 더보기/접기 버튼으로 결과 표시 최적화

### 2. AI 뷰티 상담
- **Groq AI 연동**: Llama 3.3 70B 모델 사용
- **맞춤형 프롬프트**: 친절한 뷰티 전문가 말투 설정
- **피부 타입 연동**: 사용자 프로필 기반 맞춤 상담

### 3. 팁 페이지
- 피부 타입별 화장법 팁
- 베이스 메이크업 가이드
- 카테고리별 필터링 (전체/지성/건성/복합성/민감성)

### 4. 마이페이지
- 피부 타입 설정 (지성/건성/복합성/민감성)
- 피부 고민 선택 (모공, 주름, 색소침착 등)
- 내 피해야 할 성분 관리 (피부 타입별 추천)
- 즐겨찾기 기능
- 다크모드 토글

### 5. UI/UX
- **디자인 테마**: 토스뱅크 스타일, 미니멀 & 트렌디
- **폰트**: Pretendard (깔끔한 한글 폰트)
- **다크모드**: 완벽 지원
- **페이지 전환**: 부드러운 슬라이드 업 애니메이션

---

## 🔧 주요 문제점 및 해결 과정

### 1. 식약처 API 연동 실패 (404 에러)

**문제**: API 엔드포인트가 404 반환

**시도한 것들**:
- `getIngdInfo` ❌
- `getCsmtcsIngdCpntInfo` ❌
- `getList` ❌

**해결**: data.go.kr Swagger UI에서 직접 테스트 후 정확한 오퍼레이션 이름 발견
```
정답: getCsmtcsIngdCpntInfoService01
```

**최종 URL**:
```
https://apis.data.go.kr/1471000/CsmtcsIngdCpntInfoService01/getCsmtcsIngdCpntInfoService01
```

---

### 2. 다크모드 텍스트 안 보임

**문제**: 야간모드 적용 시 제목/버튼 텍스트가 배경과 같은 색이라 안 보임

**원인**: 
- 전역 CSS에서 `!important`로 텍스트 색상 강제 지정
- Tailwind의 `dark:` 클래스와 충돌

**해결**: 
- `globals.css`의 강제 색상 오버라이드 제거
- 각 컴포넌트에 `dark:text-gray-100` 등 개별 적용
- 화살표 아이콘 `dark:text-gray-300`으로 명암 조절

---

### 3. 서버 자주 죽음 (파일 잠금 오류)

**문제**: Windows에서 페이지 전환 시 서버 크래시
```
UNKNOWN: unknown error, open '...layout.js'
```

**해결**: 
- Next.js Turbopack 사용 (`next dev --turbo`)
- `package.json` 수정:
```json
"scripts": {
  "dev": "next dev --turbo"
}
```

---

### 4. 페이지 전환 애니메이션 깜빡임

**문제**: 페이지 전환 시 0.2초 딜레이 후 깜빡이는 느낌

**해결**: `framer-motion` 설정 최적화
```typescript
<motion.div
  initial={{ y: 12 }}
  animate={{ y: 0 }}
  transition={{
    duration: 0.25,
    ease: [0.33, 1, 0.68, 1], // easeOutCubic
  }}
>
```
- `opacity` 제거 (깜빡임 원인)
- `y` 값만 사용하여 부드럽게 올라오는 효과

---

### 5. GitHub Push 실패

**문제 1**: `node_modules` 커밋됨 (대용량 파일)
**해결**: `.gitignore` 추가, `git rm --cached` 실행

**문제 2**: `.env.local` 커밋됨 (API 키 노출)
**해결**: `git reset`, `.gitignore`에 `.env*.local` 추가

---

### 6. AI 연동 문제

**문제**: Gemini API 연결 실패 (500 에러)

**해결**: Groq API로 변경
- 무료 사용 가능
- Llama 3.3 70B 모델 사용
- 한국어 응답 품질 양호 (간혹 영어 단어 섞임)

---

### 7. .env.local 인코딩 문제

**문제**: PowerShell `echo`로 생성한 파일이 환경변수로 인식 안 됨

**해결**: UTF-8 인코딩으로 재생성
```powershell
[System.IO.File]::WriteAllText(".env.local", "KEY=VALUE`n", [System.Text.Encoding]::UTF8)
```

---

## 📁 프로젝트 구조

```
cosmetic-app/
├── app/
│   ├── page.tsx          # 홈 화면
│   ├── search/           # 검색 페이지
│   ├── tips/             # 팁 페이지
│   ├── chat/             # AI 상담 페이지
│   ├── scan/             # 스캔 페이지 (개발중)
│   ├── mypage/           # 마이페이지
│   │   ├── profile/      # 프로필 설정
│   │   ├── settings/     # 앱 설정
│   │   ├── favorites/    # 즐겨찾기
│   │   └── avoid-list/   # 피해야 할 성분
│   ├── ingredient/[id]/  # 성분 상세
│   └── api/
│       ├── ingredients/  # 식약처 API
│       └── chat/         # Groq AI API
├── components/
│   ├── BottomNav.tsx     # 하단 네비게이션
│   └── PageTransition.tsx # 페이지 전환 애니메이션
├── contexts/
│   └── ThemeContext.tsx  # 다크모드 관리
├── data/
│   └── ingredients.ts    # 로컬 성분 데이터
└── .env.local            # API 키 (비공개)
```

---

## 🔑 환경 변수

```env
DATA_GO_KR_API_KEY=xxx  # 식약처 API 키
GROQ_API_KEY=xxx        # Groq AI API 키
```

---

## 📝 향후 개발 예정

- [ ] 카메라 연동 (바코드/성분표 스캔)
- [ ] 커뮤니티 기능
- [ ] PWA 변환 (앱처럼 설치)
- [ ] 성분 조합 추천 기능

---

## 📅 개발 일자

- **2026년 1월**: 기획 및 초기 개발
- **최종 업데이트**: 2026-01-22
